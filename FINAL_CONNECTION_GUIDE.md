# ğŸ¯ Ğ¤Ğ˜ĞĞĞ›Ğ¬ĞĞ«Ğ™ Ğ³Ğ°Ğ¹Ğ´ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞĞ«Ğ™)

## âœ… **21 Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ½Ğ¾Ğ´Ğ° Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ**

### ğŸ“Š **ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹ (28 ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹)**

| â„– | ĞÑ‚ Ğ½Ğ¾Ğ´Ñ‹ | Ğš Ğ½Ğ¾Ğ´Ğµ | Ğ¢Ğ¸Ğ¿ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---------|--------|-----|----------|
| 1 | `telegram-trigger` | `message-parser` | main | Ğ’Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ |
| 2 | `message-parser` | `message-router` | main | ĞŸĞ°Ñ€ÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ |
| 3 | `message-router` (Output 0) | `subscription-checker` | main | /start |
| 4 | `message-router` (Output 1) | `subscription-checker` | main | /tarif |
| 5 | `message-router` (Output 2) | `subscription-checker` | main | /oplata |
| 6 | `message-router` (Output 3) | `subscription-checker` | main | /help |
| 7 | `message-router` (Output 4) | `download-voice-file` | main | Ğ“Ğ¾Ğ»Ğ¾Ñ â­ |
| 8 | `message-router` (Output 5) | `subscription-checker` | main | Ğ¤Ğ¾Ñ‚Ğ¾ |
| 9 | `message-router` (Output 6) | `subscription-checker` | main | Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ |
| 10 | `message-router` (Output 7) | `subscription-checker` | main | Fallback |
| 11 | `subscription-checker` | `start-response` | main | ĞÑ‚Ğ²ĞµÑ‚ /start |
| 12 | `subscription-checker` | `subscription-response` | main | ĞÑ‚Ğ²ĞµÑ‚ /tarif |
| 13 | `subscription-checker` | `payment-response` | main | ĞÑ‚Ğ²ĞµÑ‚ /oplata |
| 14 | `subscription-checker` | `help-response` | main | ĞÑ‚Ğ²ĞµÑ‚ /help |
| 15 | `subscription-checker` | `subscription-gate` | main | Ğš AI gate |
| 16 | `subscription-checker` | `fallback-response` | main | ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ¾ |
| 17 | `download-voice-file` | `transcribe-voice` | main | Ğ¤Ğ°Ğ¹Ğ» |
| 18 | `transcribe-voice` | `update-transcribed-message` | main | Ğ¢ĞµĞºÑÑ‚ |
| 19 | `update-transcribed-message` | `subscription-gate` | main | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ |
| 20 | `subscription-gate` (True) | `ai-realtor-agent` | main | Ğ•ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° |
| 21 | `subscription-gate` (False) | `free-request-gate` | main | ĞĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |
| 22 | `free-request-gate` (True) | `ai-realtor-agent` | main | Ğ•ÑÑ‚ÑŒ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ |
| 23 | `free-request-gate` (False) | `limit-exceeded-response` | main | Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Ğ¸ÑÑ‡ĞµÑ€Ğ¿Ğ°Ğ½ |
| 24 | `openai-chat-model` | `ai-realtor-agent` | ai_languageModel | ğŸŸ¢ ĞœĞ¾Ğ´ĞµĞ»ÑŒ |
| 25 | `postgres-memory` | `ai-realtor-agent` | ai_memory | ğŸŸ£ ĞŸĞ°Ğ¼ÑÑ‚ÑŒ |
| 26 | `knowledge-vector-store` | `ai-realtor-agent` | ai_tool | ğŸŸ  Ğ‘Ğ°Ğ·Ğ° Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ |
| 27 | `ai-realtor-agent` | `ai-response` | main | ĞÑ‚Ğ²ĞµÑ‚ Ğ˜Ğ˜ |
| 28 | `ai-response` | `log-conversation` | main | Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ |
| 29 | `log-conversation` | `update-request-counter` | main | Ğ¡Ñ‡ĞµÑ‚Ñ‡Ğ¸Ğº |

---

## ğŸ¨ **Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ…ĞµĞ¼Ğ° (Ñ„Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Telegram Triggerâ”‚ (1)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ [1]
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Message Parser  â”‚ (2)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ [2]
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Message Router  â”‚[7]â”€â–¶â”‚ Download Voice   â”‚ (10)
â”‚     (3)         â”‚     â”‚ File             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚[3,4,5,6,8,9,10]       â”‚ [17]
          â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Subscription    â”‚     â”‚ Transcribe Voice â”‚ (11)
â”‚ Checker (4)     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ [18]
          â”‚[11,12,13,14,15,16]    â–¼
          â–¼                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ Update Message   â”‚ (12)
â”‚ 6 Response      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Handlers        â”‚                 â”‚ [19]
â”‚ (5,6,7,8,9,20)  â”‚                 â–¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Subscription Gateâ”‚ (13)
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚[20,21]
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Free Request Gateâ”‚ (14)
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚[22,23]
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ AI Realtor Agent â”‚ (15) â—€â”€[24]â”€â”€ (16) OpenAI Model
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â—€â”€[25]â”€â”€ (17) Postgres Memory  
                                    â”‚           â—€â”€[26]â”€â”€ (18) Vector Store
                                    â”‚ [27]
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ AI Response      â”‚ (19)
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ [28]
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Log Conversation â”‚ (21)
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ [29]
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Update Counter   â”‚ (22)
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Ğ§Ğ¸ÑĞ»Ğ° Ğ² ÑĞºĞ¾Ğ±ĞºĞ°Ñ… () = ID Ğ½Ğ¾Ğ´Ñ‹, Ñ‡Ğ¸ÑĞ»Ğ° Ğ² ÑĞºĞ¾Ğ±ĞºĞ°Ñ… [] = Ğ½Ğ¾Ğ¼ĞµÑ€ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ*

---

## âš¡ **Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ñ‡ĞµĞº-Ğ»Ğ¸ÑÑ‚**

### âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑÑ‚Ğ¸ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ:

1. **Message Router Ğ¸Ğ¼ĞµĞµÑ‚ 8 Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ¾Ğ²**:
   - [ ] 7 Ğ¸Ğ´ÑƒÑ‚ Ğº `subscription-checker`
   - [ ] 1 Ğ¸Ğ´ĞµÑ‚ Ğº `download-voice-file` (Output 4 = voice)

2. **Subscription Checker Ğ¸Ğ¼ĞµĞµÑ‚ 6 Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ¾Ğ²** (Ğ²ÑĞµ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ğµ):
   - [ ] Ğš 4 response handlers
   - [ ] Ğš subscription-gate  
   - [ ] Ğš fallback-response

3. **AI Agent Ğ¸Ğ¼ĞµĞµÑ‚ 5 Ğ²Ñ…Ğ¾Ğ´Ğ¾Ğ²**:
   - [ ] 2 main (Ğ¾Ñ‚ gates)
   - [ ] ğŸŸ¢ 1 ai_languageModel
   - [ ] ğŸŸ£ 1 ai_memory
   - [ ] ğŸŸ  1 ai_tool

4. **Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ°**:
   - [ ] ai-agent â†’ ai-response â†’ log â†’ counter

---

## ğŸš¨ **Ğ§Ñ‚Ğ¾ ĞĞ• Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ°Ñ‚ÑŒ**

âŒ **Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ½Ñ‹Ğµ ÑƒĞ·Ğ»Ñ‹**:
- ~~`check-subscription`~~ - Ğ±Ñ‹Ğ» Ğ² JSON, Ğ½Ğ¾ Ğ½Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½

âŒ **ĞĞ• ÑĞ¾ĞµĞ´Ğ¸Ğ½ÑĞ¹Ñ‚Ğµ**:
- Response handlers Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ¾Ğ±Ğ¾Ğ¹
- AI components Ğº main Ğ²Ñ…Ğ¾Ğ´Ğ°Ğ¼
- ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ main Ğº Ğ¾Ğ´Ğ½Ğ¾Ğ¼Ñƒ Ğ²Ñ…Ğ¾Ğ´Ñƒ

---

## ğŸ“Š **Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°**

- **ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑƒĞ·Ğ»Ğ¾Ğ²**: 21
- **Ğ¡Ğ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹**: 29
- **Main connections**: 26  
- **AI connections**: 3
- **Response handlers**: 6 (ĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ñ‚Ğ¾Ñ‡ĞºĞ¸)

---

## âœ… **Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ!**

Ğ­Ñ‚Ğ° ÑÑ…ĞµĞ¼Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ğ¾Ğ¼Ñƒ JSON Ñ„Ğ°Ğ¹Ğ»Ñƒ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñƒ Ğ² n8n. Ğ’ÑĞµ 29 ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ¸ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸.

**Ğ¡Ğ»ĞµĞ´ÑƒĞ¹Ñ‚Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾, Ğ¸ Ğ²Ğ°Ñˆ workflow Ğ±ÑƒĞ´ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾!** ğŸš€